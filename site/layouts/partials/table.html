<!-- Result counter and clear filters -->
<div class="result-info">
    <div>Showing <strong id="resultCount">0</strong> apps</div>
    <button id="clearFilters" class="clear-filters-btn">Clear All Filters</button>
</div>

<table id="appsTable">
    <thead>
        <!-- Row 1: Column names with tooltips -->
        <tr>
            <th data-tooltip="Application name">App</th>
            <th data-tooltip="App category (Collaboration, Productivity, Development, Sales)">Category</th>
            <th data-tooltip="Does this app support SSO? Shows checkmark and minimum tier needed">SSO</th>
            <th data-tooltip="Which SSO protocols does this app support?">SSO Protocols</th>
            <th data-tooltip="Does this app support automated user provisioning via SCIM?">SCIM</th>
            <th data-tooltip="Does this app support MFA? Shows how it can be enforced">MFA</th>
            <th data-tooltip="Which MFA methods does this app support?">MFA Types</th>
            <th data-tooltip="Which security certifications does this app have?">Compliance</th>
            <th data-tooltip="When we last verified this information">Last Verified</th>
        </tr>

        <!-- Row 2: Filter dropdowns -->
        <tr class="filter-row">
            <th><select id="filterApp">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterCategory">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterSSO">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterSSOProtocols">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterSCIM">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterMFA">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterMFATypes">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterCompliance">
                    <option value="">All</option>
                </select></th>
            <th><select id="filterVerified">
                    <option value="">All</option>
                </select></th>
        </tr>
    </thead>
    <tbody>
        {{ range $.Site.Data.apps }}
        <tr>
            <!-- App Name -->
            <td data-app="{{ .name }}"><a href="{{ .website }}" target="_blank" rel="noopener">{{ .name }}</a></td>

            <!-- Category -->
            <td data-category="{{ .category }}" style="text-transform: capitalize;">{{ .category }}</td>

            <!-- SSO -->
            <td data-sso="{{ if .sso.supported }}{{ .sso.tier }}{{ else }}none{{ end }}">
                {{ if .sso.supported }}
                <span class="check">✓</span>
                <span class="tier">{{ .sso.tier }}</span>
                {{ else }}
                <span class="cross">✗</span>
                {{ end }}
            </td>

            <!-- SSO Protocols -->
            <td data-sso-protocols="{{ delimit .sso.protocols " ," }}">
                {{ if .sso.supported }}
                {{ delimit .sso.protocols ", " }}
                {{ else }}
                <span class="cross">—</span>
                {{ end }}
            </td>

            <!-- SCIM -->
            <td data-scim="{{ .scim.supported }}">
                {{ if eq .scim.supported "full" }}
                <span class="check">✓</span>
                <span class="tier">{{ .scim.tier }}</span>
                {{ else if eq .scim.supported "partial" }}
                <span class="partial">~</span>
                <span class="tier">{{ .scim.tier }}</span>
                {{ else if eq .scim.supported true }}
                <span class="check">✓</span>
                <span class="tier">{{ .scim.tier }}</span>
                {{ else }}
                <span class="cross">✗</span>
                {{ end }}
            </td>

            <!-- MFA -->
            <td data-mfa="{{ if .mfa.supported }}{{ .mfa.enforcement }}{{ else }}none{{ end }}">
                {{ if .mfa.supported }}
                <span class="check">✓</span>
                {{ if eq .mfa.enforcement "admin_enforced" }}
                Admin enforced
                {{ else if eq .mfa.enforcement "optional" }}
                Optional
                {{ else if eq .mfa.enforcement "required" }}
                Required
                {{ else }}
                {{ .mfa.enforcement }}
                {{ end }}
                {{ else }}
                <span class="cross">✗</span>
                {{ end }}
            </td>

            <!-- MFA Types -->
            <td data-mfa-types="{{ delimit .mfa.types " ," }}">
                {{ if .mfa.supported }}
                {{ delimit .mfa.types ", " }}
                {{ else }}
                <span class="cross">—</span>
                {{ end }}
            </td>

            <!-- Compliance -->
            <td
                data-compliance="{{ if .compliance.soc2 }}soc2{{ end }}{{ if and .compliance.soc2 .compliance.iso27001 }},{{ end }}{{ if .compliance.iso27001 }}iso27001{{ end }}">
                {{ if .compliance.soc2 }}SOC2{{ end }}{{ if and .compliance.soc2 .compliance.iso27001 }}, {{ end }}{{ if
                .compliance.iso27001 }}ISO27001{{ end }}
                {{ if and (not .compliance.soc2) (not .compliance.iso27001) }}<span class="cross">—</span>{{ end }}
            </td>

            <!-- Last Verified -->
            <td data-verified="{{ .meta.last_verified }}">{{ .meta.last_verified }}</td>
        </tr>
        {{ end }}
    </tbody>
</table>